# metadata1

metadata1是登录亚马逊的时候，页面动态计算产生的一个字段，其内容经过加密混淆之后传回亚马逊并进行服务器端校验，从而阻止直接通过Http Post的方式绕过浏览器直接登录。

## metadata1包含了如下信息：
* 鼠标键盘交互信息  记录点击位置，点击次数，点击间隔，按键次数，按键间隔
* 页面加载的脚本的哈希信息  防止页面被篡改
* 浏览器的指纹  屏幕分辨率/插件/CSS/JS能力
* 电池信息  充电与否/充电时长
* 性能信息  页面加载的速度，各种时间基准
* 表单信息  记录email/password字段的点击位置，点击次数，点击间隔，按键次数，按键间隔

* CANVAS绘图/CRC校验/抽样

## 意义
通过复原metadata1，可以实现Http Post方式直接登录亚马逊，降低了自动化的难度，提高了执行效率；同时由于可以随意组合校验信息内的特征，一套方案即可模仿多种浏览器及软硬件环境。

## 接口
##### 参数
* email
* browserType [Chrome/Firefox/Edge/Internet Explorer]

##### 输出结果
ECdITeCs:4qz+eH24hr1pf+gx/vaqUcKtAqROfvGzo+...

##### 样本
0265AC6A#{"start":1554047243584,"interaction":{"keys":24,"keyPressTimeIntervals":[197,1149,363,1251,946,1761,368,543,292,521,1550,1726,125,631,1786,445,204,1161,797,942,471,1780,833,1159],"copies":0,"cuts":0,"pastes":0,"clicks":5,"touches":0,"mouseClickPositions":["836,172","919,129","850,271","859,147","880,279"],"keyCycles":[143,68,36,158,66,95,47,181,29,186,166,144,186,43,63,126,74,33,74,101,119,0,81,9],"mouseCycles":[96,95,102,103,67]},"version":"3.0.0","lsUbid":"X58-0986400-6713468:1552303074","timeZone":-8,"scripts":{"dynamicUrls":["https://images-na.ssl-images-amazon.com/images/I/61HHaoAEflL._RC|11-BZEJ8lnL.js,61q-U9rAZ3L.js,31x4ENTlVIL.js,31f4+QIEeqL.js,01N6xzIJxbL.js,518BI433aLL.js,01rpauTep4L.js,31QZSjMuoeL.js,61ofwvddDeL.js,01KsMxlPtzL.js_.js?AUIClients/AmazonUI","https://images-na.ssl-images-amazon.com/images/I/21T7I7qVEeL._RC|21T1XtqIBZL.js,21WEJWRAQlL.js,31DwnWh8lFL.js,21VKEfzET-L.js,01fHQhWQYWL.js,51R1ftc2MoL.js_.js?AUIClients/AuthenticationPortalAssets","https://images-na.ssl-images-amazon.com/images/I/0173Lf6yxEL.js?AUIClients/AuthenticationPortalInlineAssets","https://images-na.ssl-images-amazon.com/images/I/21Xqu3WntzL.js?AUIClients/CVFAssets","https://images-na.ssl-images-amazon.com/images/G/01/x-locale/common/login/fwcim._CB454428048_.js"],"inlineHashes":[-1746719145,-299177469,-314038750,-1263299411,2118203618,318224283,-1228118292,-1611905557,1800521327,-1171760960,1338172715],"elapsed":29,"dynamicUrlCount":5,"inlineHashesCount":11},"plugins":"Chrome PDF Plugin Chrome PDF Viewer Native Client ||1920-1080-1040-24-*-*-*","dupedPlugins":"Chrome PDF Plugin Chrome PDF Viewer Native Client ||1920-1080-1040-24-*-*-*","screenInfo":"1920-1080-1040-24-*-*-*","capabilities":{"js":{"audio":true,"geolocation":true,"localStorage":"supported","touch":false,"video":true,"webWorker":true},"css":{"textShadow":true,"textStroke":true,"boxShadow":true,"borderRadius":true,"borderImage":true,"opacity":true,"transform":true,"transition":true},"elapsed":0},"referrer":"https://www.amazon.com/","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.119 Safari/537.36","location":"https://www.amazon.com/ap/signin?openid.pape.max_auth_age=0&openid.return_to=https%3A%2F%2Fwww.amazon.com%2F%3Fref_%3Dnav_ya_signin&openid.identity=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select&openid.assoc_handle=usflex&openid.mode=checkid_setup&openid.claimed_id=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0%2Fidentifier_select&openid.ns=http%3A%2F%2Fspecs.openid.net%2Fauth%2F2.0&","webDriver":null,"history":{"length":4},"gpu":{"vendor":"Google Inc.","model":"ANGLE (Intel(R) UHD Graphics 620 Direct3D11 vs_5_0 ps_5_0)","extensions":["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_frag_depth","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic","EXT_sRGB","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context","WEBKIT_WEBGL_lose_context"]},"battery":{"charging":true,"level":1,"chargingTime":0,"dischargingTime":-1},"dnt":null,"math":{"tan":"-1.4214488238747245","sin":"0.8178819121159085","cos":"-0.5753861119575491"},"performance":{"timing":{"navigationStart":1554047255508,"unloadEventStart":1554047255816,"unloadEventEnd":1554047255879,"redirectStart":0,"redirectEnd":0,"fetchStart":1554047255513,"domainLookupStart":1554047255513,"domainLookupEnd":1554047255513,"connectStart":1554047255513,"connectEnd":1554047255513,"secureConnectionStart":0,"requestStart":1554047255514,"responseStart":1554047255842,"responseEnd":1554047255924,"domLoading":1554047255826,"domInteractive":1554047257170,"domContentLoadedEventStart":1554047257170,"domContentLoadedEventEnd":1554047257171,"domComplete":1554047263298,"loadEventStart":1554047263298,"loadEventEnd":1554047263302}},"end":1554047255505,"timeToSubmit":11921,"form":{"email":{"keys":14,"keyPressTimeIntervals":[197,1149,363,1251,946,1761,368,543,292,521,1550,1726,125,631],"copies":0,"cuts":0,"pastes":0,"clicks":2,"touches":0,"mouseClickPositions":["124,1","121,1"],"keyCycles":[143,68,36,158,66,95,47,181,29,186,166,144,186,43],"mouseCycles":[91,88],"width":296,"height":31,"checksum":"46C13B8B","time":2680,"autocomplete":false,"prefilled":false},"password":{"keys":14,"keyPressTimeIntervals":[197,1149,363,1251,946,1761,368,543,292,521,1550,1726,125,631],"copies":0,"cuts":0,"pastes":0,"clicks":2,"touches":0,"mouseClickPositions":["83,21","80,21"],"keyCycles":[143,68,36,158,66,95,47,181,29,186,166,144,186,43],"mouseCycles":[91,88],"width":296,"height":31,"time":2703,"autocomplete":false,"prefilled":false}},"canvas":{"hash":569667045,"emailHash":-1523767732,"histogramBins":[12107,22,34,36,41,43,39,40,29,178,32,19,26,25,82,55,34,75,99,51,34,20,24,27,45,37,21,44,61,38,48,34,26,28,25,149,48,26,23,53,40,24,23,41,58,19,15,44,38,27,84,56,23,32,22,40,15,20,42,66,35,20,28,26,25,20,49,24,18,25,30,24,113,54,64,30,15,19,54,26,26,24,24,58,13,39,35,58,27,36,21,21,83,54,26,22,47,12,56,27,46,93,445,36,95,93,17,23,32,40,69,39,18,28,45,22,46,69,49,40,31,16,47,32,39,26,57,92,244,94,18,33,32,24,17,24,31,38,54,54,20,24,21,25,41,63,42,40,21,6,35,56,36,76,34,22,16,24,13,7,13,30,60,69,30,58,9,13,50,24,22,7,50,12,8,16,39,32,5,10,19,13,69,77,39,9,12,5,29,41,15,17,27,15,36,50,55,26,16,23,59,25,39,31,59,82,27,45,66,17,39,89,68,21,26,30,37,29,42,30,100,30,18,26,61,38,37,140,63,46,36,37,38,26,36,30,87,78,69,16,91,111,27,46,68,51,182,43,85,36,25,85,63,38,53,12988]},"token":null,"errors":[],"metrics":[{"n":"fwcim-mercury-collector","t":0},{"n":"fwcim-instant-collector","t":0},{"n":"fwcim-element-telemetry-collector","t":1},{"n":"fwcim-script-version-collector","t":0},{"n":"fwcim-local-storage-identifier-collector","t":0},{"n":"fwcim-timezone-collector","t":0},{"n":"fwcim-script-collector","t":0},{"n":"fwcim-plugin-collector","t":0},{"n":"fwcim-capability-collector","t":0},{"n":"fwcim-browser-collector","t":0},{"n":"fwcim-history-collector","t":0},{"n":"fwcim-gpu-collector","t":1},{"n":"fwcim-battery-collector","t":0},{"n":"fwcim-dnt-collector","t":1},{"n":"fwcim-math-fingerprint-collector","t":0},{"n":"fwcim-performance-collector","t":0},{"n":"fwcim-timer-collector","t":0},{"n":"fwcim-time-to-submit-collector","t":0},{"n":"fwcim-form-input-telemetry-collector","t":1},{"n":"fwcim-canvas-collector","t":26},{"n":"fwcim-captcha-telemetry-collector","t":0},{"n":"fwcim-proof-of-work-collector","t":0},{"n":"fwcim-ubf-collector","t":0},{"n":"fwcim-timer-collector","t":0}]}


![](https://github.com/571914/metadata1/blob/master/wechat.jpg)  
